<!DOCTYPE html>
<html lang="en">
  <head>
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
    <link rel="stylesheet" href="main.css">
    <title>Twittler</title>
  </head>
  <body>
    <h1>
      <a>Twittler</a>
    </h1>  

    <button class="refresh">Refresh Tweets</button>
    <ul>
      
    </ul>


    <script>

      $(document).ready(function(){
        var $ul = $('ul');
        //$body.html('');

        function formatTweet(index){
          var tweet = streams.home[index];
          var $tweet = $('<li><button id="user-filter">@' + tweet.user + '</button>: ' + tweet.message + '<p class="time">' + tweet.created_at + '</p></li>');

          return $tweet;
        }

        //load tweets
        var index = streams.home.length - 1;
        while(index >= 0){
          formatTweet(index).appendTo($ul);
          index -= 1;
        }

        //refresh when button is clicked
        $('.refresh').on('click', function(){
          if(streams.home.length > $('li').length) {
            //add new tweets to top
            var newTweetsEnd = streams.home.length - 1;
            var newTweets = $('li').length;
            while(newTweets <= newTweetsEnd) {
              formatTweet(newTweets).prependTo($ul);
              newTweets += 1;
            }
          }
        });

        //add class to li for username
        $('ul li').each(function(){
          $(this).addClass($(this).find('#user-filter').text().slice(1));      
        });


        //when user button is clicked, filter results
        $('ul #user-filter').on('click', function(){
          var filterName = $(this).text().slice(1);
          //$(this).addClass('filter');
          //event handler to (addClass? or remove that list item)
          //loop through all tweets, if tweet.user !== buttom
          $('.' + filterName).toggleClass('user-selected');
          //show only li with .user-selected 
          
        });



      });

    </script>
  </body>
</html>
